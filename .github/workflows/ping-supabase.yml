name: Ping Supabase

on:
  schedule:
    # 5일마다 KST 03:00 (UTC 18:00) - Supabase 깨우기
    - cron: '0 18 */5 * *'
  workflow_dispatch:

env:
  SUPABASE_URL: ${{ secrets.SUPABASE_URL }}

jobs:
  ping:
    name: Ping Supabase
    runs-on: ubuntu-latest
    steps:
      - name: Ping Supabase to keep awake
        shell: bash
        run: |
          set -euo pipefail
          echo "Pinging Supabase..."
          code=$(curl -sS --max-time 15 -o /dev/null -w "%{http_code}" "$SUPABASE_URL/rest/v1/" || echo "000")
          echo "Supabase response: $code"
          if [ "$code" != "200" ] && [ "$code" != "401" ]; then
            echo "Warning: Supabase responded with $code"
          fi
