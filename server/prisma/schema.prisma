// server/prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

// ì‚¬ìš©ì ì—­í•  (ê´€ë¦¬ì / ê°•ì‚¬)
enum UserRole {
  ADMIN      // ê´€ë¦¬ì
  INSTRUCTOR // ê°•ì‚¬
}

// ê°•ì‚¬ ìœ í˜• (ì£¼ê°•ì‚¬ / ë¶€ê°•ì‚¬ / ë³´ì¡°ê°•ì‚¬)
enum InstructorType {
  MAIN      // ì£¼ê°•ì‚¬
  SUB       // ë¶€ê°•ì‚¬
  ASSISTANT // ë³´ì¡°ê°•ì‚¬
}

// ì‚¬ìš©ì ê³„ì • ìƒíƒœ (ìŠ¹ì¸ ëŒ€ê¸°, ìŠ¹ì¸ë¨, ë¹„í™œì„±í™”ë¨)
enum UserStatus {
  PENDING     // ê´€ë¦¬ì ìŠ¹ì¸ ëŒ€ê¸°
  APPROVED    // ìŠ¹ì¸ë¨
  DEACTIVATED // ë¹„í™œì„±í™”ë¨
}

// =========================================
// ğŸ‘¤ ì‚¬ìš©ì (User) - ê°•ì‚¬ ë° ê´€ë¦¬ì
// =========================================
model User {
  id            Int     @id @default(autoincrement())
  email         String  @unique // ì´ë©”ì¼/ID (ë¡œê·¸ì¸ìš©)
  password      String  // ë¹„ë°€ë²ˆí˜¸ (ë°˜ë“œì‹œ í•´ì‹œí•˜ì—¬ ì €ì¥)
  name          String  // ì´ë¦„
  contactNumber String? // ì—°ë½ì²˜
  address       String? // ê±°ì£¼ì§€ ì£¼ì†Œ
  addressLat    Float?  // ê±°ì£¼ì§€ ìœ„ë„ (ì§€ë„ ê¸°ëŠ¥)
  addressLng    Float?  // ê±°ì£¼ì§€ ê²½ë„ (ì§€ë„ ê¸°ëŠ¥)
  hasCar        Boolean @default(false) // ìì°¨ ì—¬ë¶€

  // [ìš”ì²­ì‚¬í•­ ë°˜ì˜]
  role           UserRole       @default(INSTRUCTOR) // ê´€ë¦¬ì/ê°•ì‚¬ êµ¬ë¶„
  instructorType InstructorType? // ê°•ì‚¬ ìœ í˜• (ì£¼/ë¶€/ë³´ì¡°) - ê°•ì‚¬ì¼ ê²½ìš°ì—ë§Œ í•´ë‹¹
  status         UserStatus     @default(PENDING)   // ê³„ì • ìƒíƒœ (ìŠ¹ì¸ ëŒ€ê¸° ë“±)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // ë‹¤ë¥¸ ëª¨ë¸(Batch, Assignment ë“±)ê³¼ì˜ ê´€ê³„ëŠ” ì¶”í›„ ì¶”ê°€
}

// =========================================
// ğŸ“ ê°•ì˜ì¥ì†Œ (Lecture Location)
// =========================================
model LectureLocation {
  id                       Int      @id @default(autoincrement())
  unitName                 String   // ë¶€ëŒ€ëª…
  address                  String   // ì£¼ì†Œ
  contactPerson            String   // ë¶€ëŒ€ ë‹´ë‹¹ìëª…
  contactNumber            String   // ë‹´ë‹¹ìë²ˆí˜¸
  isCateringAvailable      Boolean  @default(false) // ìˆ˜íƒê¸‰ì‹ì—¬ë¶€
  isAccommodationAvailable Boolean  @default(false) // íšŒê´€ìˆ™ì‹ì—¬ë¶€
  restAreaNotes            String?  // ê°•ì‚¬ íœ´ê²Œì‹¤ ë° ì—¬ì í™”ì¥ì‹¤ ì—¬ë¶€ (ë‹¨ìˆœ O/Xë³´ë‹¤ ìƒì„¸ ì •ë³´ê°€ í•„ìš”í•  ìˆ˜ ìˆì–´ String ì¶”ì²œ)

  dailyDetails             DailyEducationDetail[]   // 1:N ê´€ê³„ ì„¤ì •

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// =========================================
// ğŸ“… ì¼ìë³„ êµìœ¡ ì„¸ë¶€ì •ë³´ (Daily Education Detail)
// =========================================
model DailyEducationDetail {
  id                Int      @id @default(autoincrement())
  date              DateTime // ğŸ“… ê°•ì˜ ê°€ëŠ” ë‚ ì§œ
  traineeCount      Int      // ğŸ‘¥ êµìœ¡ ì¸ì›
  facilityNote      String?  // ğŸ“ ë¹„ê³  (TV, ë§ˆì´í¬ ë“± ë³€ë™ì‚¬í•­)
  specificLocation  String?
  lectureLocationId Int
  lectureLocation   LectureLocation @relation(fields: [lectureLocationId], references: [id], onDelete: Cascade)

  @@unique([lectureLocationId, date])
}