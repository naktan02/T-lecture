// í…ŒìŠ¤íŠ¸ìš© ì—‘ì…€ íŒŒì¼ ìƒì„± ìŠ¤í¬ë¦½íŠ¸ (ëª¨ë“  í•„ë“œ í¬í•¨)
// ì‹¤í–‰: npx tsx scripts/generate-test-excel.ts

import ExcelJS from 'exceljs';
import path from 'path';

async function generateTestExcel() {
  const workbook = new ExcelJS.Workbook();
  const worksheet = workbook.addWorksheet('ë¶€ëŒ€ì •ë³´');

  // í—¤ë” (DB í•„ë“œëª… - ëª¨ë“  í•„ë“œ)
  const headers = [
    // Unit ê¸°ë³¸ì •ë³´
    'ë¶€ëŒ€ëª…',
    'êµ°êµ¬ë¶„',
    'ê´‘ì—­',
    'ì§€ì—­',
    'ë¶€ëŒ€ìƒì„¸ì£¼ì†Œ',
    'ìœ„ë„',
    'ê²½ë„',
    // êµìœ¡ ì¼ì •
    'êµìœ¡ì‹œì‘ì¼ì',
    'êµìœ¡ì¢…ë£Œì¼ì',
    'êµìœ¡ë¶ˆê°€ì¼ì',
    // ê·¼ë¬´ ì‹œê°„
    'ê·¼ë¬´ì‹œì‘ì‹œê°„',
    'ê·¼ë¬´ì¢…ë£Œì‹œê°„',
    'ì ì‹¬ì‹œì‘ì‹œê°„',
    'ì ì‹¬ì¢…ë£Œì‹œê°„',
    // ë‹´ë‹¹ì ì •ë³´
    'ê°„ë¶€ëª…',
    'ê°„ë¶€ ì „í™”ë²ˆí˜¸',
    'ê°„ë¶€ ì´ë©”ì¼ ì£¼ì†Œ',
    // TrainingLocation ì •ë³´
    'ê¸°ì¡´êµìœ¡ì¥ì†Œ',
    'ë³€ê²½êµìœ¡ì¥ì†Œ',
    'ê°•ì‚¬íœ´ê²Œì‹¤ ì—¬ë¶€',
    'ì—¬ìí™”ì¥ì‹¤ ì—¬ë¶€',
    'ìˆ˜íƒê¸‰ì‹ì—¬ë¶€',
    'íšŒê´€ìˆ™ë°•ì—¬ë¶€',
    'ì‚¬ì „ì‚¬í›„ íœ´ëŒ€í° ë¶ˆì¶œ ì—¬ë¶€',
    'ê³„íšì¸ì›',
    'ì°¸ì—¬ì¸ì›',
    'íˆ¬ì…ê°•ì‚¬ìˆ˜',
    'íŠ¹ì´ì‚¬í•­',
  ];

  worksheet.addRow(headers);

  // í…ŒìŠ¤íŠ¸ ë°ì´í„° 1 - ìœ¡êµ° ë¶€ëŒ€ (ëª¨ë“  í•„ë“œ ì±„ì›€)
  worksheet.addRow([
    // Unit ê¸°ë³¸ì •ë³´
    'ì œ1ë³´ë³‘ì‚¬ë‹¨',
    'Army',
    'ê²½ê¸°ë„',
    'íŒŒì£¼ì‹œ',
    'íŒŒì£¼ì‹œ ë¬¸ì‚°ì êµ°ì‚¬ë¡œ 123-45',
    37.8563,
    126.7812,
    // êµìœ¡ ì¼ì •
    '2025-02-01',
    '2025-02-10',
    '2025-02-05,2025-02-06', // êµìœ¡ë¶ˆê°€ì¼ì (ì½¤ë§ˆë¡œ êµ¬ë¶„)
    // ê·¼ë¬´ ì‹œê°„
    '09:00',
    '18:00',
    '12:00',
    '13:00',
    // ë‹´ë‹¹ì ì •ë³´
    'í™ê¸¸ë™',
    '010-1234-5678',
    'hong@army.mil.kr',
    // TrainingLocation ì •ë³´
    'ë³¸ë¶€ ì—°ë³‘ì¥',
    '',
    'O',
    'O',
    'O',
    'X',
    'O',
    50,
    0,
    3,
    'ì£¼ì°¨ê³µê°„ í˜‘ì†Œ',
  ]);

  // í…ŒìŠ¤íŠ¸ ë°ì´í„° 2 - í•´êµ° ë¶€ëŒ€ (ëª¨ë“  í•„ë“œ ì±„ì›€)
  worksheet.addRow([
    // Unit ê¸°ë³¸ì •ë³´
    'ì œ2í•¨ëŒ€ì‚¬ë ¹ë¶€',
    'Navy',
    'ë¶€ì‚°ê´‘ì—­ì‹œ',
    'ì˜ë„êµ¬',
    'ì˜ë„êµ¬ í•´êµ°ë¡œ 456-78',
    35.0914,
    129.0419,
    // êµìœ¡ ì¼ì •
    '2025-03-10',
    '2025-03-15',
    '', // êµìœ¡ë¶ˆê°€ì¼ì ì—†ìŒ
    // ê·¼ë¬´ ì‹œê°„
    '08:30',
    '17:30',
    '11:30',
    '12:30',
    // ë‹´ë‹¹ì ì •ë³´
    'ê¹€ì² ìˆ˜',
    '010-9876-5432',
    'kim@navy.mil.kr',
    // TrainingLocation ì •ë³´
    'í•´êµ°íšŒê´€ ëŒ€íšŒì˜ì‹¤',
    'ì†ŒíšŒì˜ì‹¤B',
    'O',
    'O',
    'O',
    'O',
    'X',
    30,
    0,
    2,
    'í”„ë¡œì í„° ì§€ì› ê°€ëŠ¥',
  ]);

  // í…ŒìŠ¤íŠ¸ ë°ì´í„° 3 - ìœ¡êµ° ë¶€ëŒ€ (ì¼ë¶€ í•„ë“œë§Œ)
  worksheet.addRow([
    // Unit ê¸°ë³¸ì •ë³´
    'ì œ3ê¸°ê°‘ì—¬ë‹¨',
    'Army',
    'ê°•ì›ë„',
    'ì² ì›êµ°',
    'ì² ì›êµ° ê°ˆë§ì êµ°ì‚¬ë¡œ 789',
    38.1469,
    127.3134,
    // êµìœ¡ ì¼ì •
    '2025-04-01',
    '2025-04-07',
    '2025-04-03',
    // ê·¼ë¬´ ì‹œê°„
    '09:00',
    '18:00',
    '12:00',
    '13:00',
    // ë‹´ë‹¹ì ì •ë³´
    'ì´ì˜í¬',
    '010-5555-6666',
    'lee@army.mil.kr',
    // TrainingLocation ì •ë³´
    'ì „ì°¨êµìœ¡ê´€',
    'ì‹ ì¶•êµìœ¡ê´€',
    'X',
    'O',
    'O',
    'O',
    'O',
    100,
    0,
    5,
    'ëŒ€í˜• êµìœ¡ì¥, ìŒí–¥ì‹œì„¤ ì™„ë¹„',
  ]);

  // ì—´ ë„ˆë¹„ ì¡°ì •
  worksheet.columns.forEach((column, index) => {
    // í•„ë“œëª…ì— ë”°ë¼ ì ì ˆí•œ ë„ˆë¹„ ì„¤ì •
    const widths = [
      15,
      10,
      12,
      12,
      30,
      12,
      12, // ê¸°ë³¸ì •ë³´
      15,
      15,
      25, // êµìœ¡ ì¼ì •
      12,
      12,
      12,
      12, // ê·¼ë¬´ ì‹œê°„
      12,
      18,
      25, // ë‹´ë‹¹ì
      20,
      20,
      15,
      15,
      12,
      12,
      22,
      10,
      10,
      12,
      25, // TrainingLocation
    ];
    column.width = widths[index] || 15;
  });

  // í—¤ë” ìŠ¤íƒ€ì¼
  const headerRow = worksheet.getRow(1);
  headerRow.font = { bold: true };
  headerRow.fill = {
    type: 'pattern',
    pattern: 'solid',
    fgColor: { argb: 'FF4472C4' },
  };
  headerRow.font = { bold: true, color: { argb: 'FFFFFFFF' } };
  headerRow.alignment = { horizontal: 'center' };

  // ë°ì´í„° í–‰ ìŠ¤íƒ€ì¼
  for (let i = 2; i <= 4; i++) {
    const row = worksheet.getRow(i);
    row.alignment = { horizontal: 'left' };
    if (i % 2 === 0) {
      row.fill = {
        type: 'pattern',
        pattern: 'solid',
        fgColor: { argb: 'FFF2F2F2' },
      };
    }
  }

  // íŒŒì¼ ì €ì¥
  const filePath = path.join(__dirname, '..', 'test-data', 'test-units-full.xlsx');
  await workbook.xlsx.writeFile(filePath);

  console.log(`âœ… í…ŒìŠ¤íŠ¸ ì—‘ì…€ íŒŒì¼ ìƒì„± ì™„ë£Œ: ${filePath}`);
  console.log(`\nğŸ“‹ í¬í•¨ëœ í•„ë“œ (ì´ ${headers.length}ê°œ):`);
  console.log('   Unit: ë¶€ëŒ€ëª…, êµ°êµ¬ë¶„, ê´‘ì—­, ì§€ì—­, ë¶€ëŒ€ìƒì„¸ì£¼ì†Œ, ìœ„ë„, ê²½ë„');
  console.log('   êµìœ¡ì¼ì •: êµìœ¡ì‹œì‘ì¼ì, êµìœ¡ì¢…ë£Œì¼ì, êµìœ¡ë¶ˆê°€ì¼ì');
  console.log('   ê·¼ë¬´ì‹œê°„: ê·¼ë¬´ì‹œì‘ì‹œê°„, ê·¼ë¬´ì¢…ë£Œì‹œê°„, ì ì‹¬ì‹œì‘ì‹œê°„, ì ì‹¬ì¢…ë£Œì‹œê°„');
  console.log('   ë‹´ë‹¹ì: ê°„ë¶€ëª…, ê°„ë¶€ ì „í™”ë²ˆí˜¸, ê°„ë¶€ ì´ë©”ì¼ ì£¼ì†Œ');
  console.log(
    '   êµìœ¡ì¥ì†Œ: ê¸°ì¡´êµìœ¡ì¥ì†Œ, ë³€ê²½êµìœ¡ì¥ì†Œ, ëª¨ë“  ì‹œì„¤ ì—¬ë¶€, ê³„íšì¸ì›, ì°¸ì—¬ì¸ì›, íˆ¬ì…ê°•ì‚¬ìˆ˜, íŠ¹ì´ì‚¬í•­',
  );
  console.log(`\nğŸ“Š í…ŒìŠ¤íŠ¸ ë°ì´í„°: 3ê°œ ë¶€ëŒ€`);
}

generateTestExcel().catch(console.error);
